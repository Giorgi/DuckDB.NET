using DuckDB.NET.Data;
using System.IO;
using Xunit;

namespace DuckDB.NET.Test;

public class OpenTests
{
    [Theory]
    [InlineData("中文", "中文.db")]
    [InlineData("english", "english.db")]
    [InlineData("한국어", "한국어.db")]
    public void OpenWithFile(string path,string fileName)
    {
        var dir = Path.Combine(path);
        if (!Directory.Exists(dir))
        {
            Directory.CreateDirectory(dir);
        }
        var file = Path.Combine(dir, fileName);
        using (var conn=new DuckDBConnection($"Data Source={file}"))
        {
            conn.Open();
        }
        try
        {
            File.Delete(file);
            Directory.Delete(dir);
        }
        catch (System.Exception)
        {
        }
    }
}
